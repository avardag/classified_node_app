<% layout('layouts/post-show-layout') -%>

<h1><%= post.title %></h1>
<div class="">Price: <%= post.price %></div>
<div class=""><%= post.description %></div>
<div class=""><%= post.location %></div>
<div class="">
  <% post.images.forEach(image=> { %>
    <img src="<%= image.url %>" alt="" width="200px">
  <% }) %>
</div>
<!-- MAP -->
<div id='map'></div>
<!-- END Map -->
<div> 
  <a href="/posts/<%= post.id %>/edit">
    <button>Edit post</button>
  </a> 
</div>
<div> 
  <form action="/posts/<%= post.id %>?_method=DELETE" method="POST">
    <input type="submit" value="Delete">
  </form>
</div>

<h2>Reviews</h2>
<h2>Create a review</h2>
<form action="/posts/<%= post.id %>/reviews" method="post">
  <div>
    <textarea name="review[body]" id=""></textarea>
  </div>
  <div>
    <input type="number" name="review[rating]" step="1" min="1" max="5" id="">
  </div>
  <div>
    <input type="submit" value="Submit">
  </div>
</form>
<!-- dipslay all reviews -->
<h3>Reviews</h3>
<% post.reviews.forEach(function(review){ %>
  <div>
    Author: <%= review.author.username %> <br>
    <%= review.body %> <br>
    Rating: <%= review.rating %>
    <div>
      <button class="toggle-edit-form">Edit</button>
      <form 
        action="/posts/<%= post.id %>/reviews/<%= review.id %>?_method=PUT" 
        method="post"
        class="edit-review-form"
        >
        <div>
          <textarea name="review[body]" id=""><%= review.body %></textarea>
        </div>
        <div>
          <input type="number" name="review[rating]" value="<%= review.rating %>" step="1" min="1" max="5" id="">
        </div>
        <div>
          <input type="submit" value="Update">
        </div>
      </form>
    </div>
    <hr>
  </div>
  
<% }) %>